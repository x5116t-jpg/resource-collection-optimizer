% ntsel-report.sty
% 技術報告書用スタイルファイル
% 
% 使用方法: \usepackage{ntsel-report}
% 前提: jsarticle または jlreq クラスで使用
%
% 作成日: 2025年11月
% ============================================================

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{ntsel-report}[2025/11/29 Technical Report Style]

% ============================================================
% パッケージ読み込み
% ============================================================

% ページレイアウト
\RequirePackage[top=25mm, bottom=25mm, left=25mm, right=25mm]{geometry}

% 数式
\RequirePackage{amsmath}
\RequirePackage{amssymb}

% 図表
\RequirePackage{graphicx}
\RequirePackage{booktabs}      % 美しい表罫線
\RequirePackage{multirow}      % 表のセル結合（行方向）
\RequirePackage{array}         % 表の拡張機能
\RequirePackage{longtable}     % 複数ページにまたがる表
\RequirePackage{subcaption}    % サブキャプション（複数図）
\RequirePackage{here}          % 図表の配置制御 [H]

% コードリスティング
\RequirePackage{listings}
\RequirePackage{xcolor}

% ヘッダー・フッター
\RequirePackage{fancyhdr}

% 見出しスタイル
\RequirePackage{titlesec}

% 目次のカスタマイズ
\RequirePackage{tocloft}

% URL表示
\RequirePackage{url}

% ハイパーリンク（最後に読み込む必要があるため AtEndPreamble で）
\RequirePackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    urlcolor=blue,
    citecolor=blue
}

% ============================================================
% ヘッダー・フッターの設定
% ============================================================
\pagestyle{fancy}
\fancyhf{}                              % 全てクリア
\fancyhead[L]{\leftmark}                % 左ヘッダー：セクション名
\fancyhead[R]{\thepage}                 % 右ヘッダー：ページ番号
\renewcommand{\headrulewidth}{0.4pt}    % ヘッダー下線の太さ

% ============================================================
% セクションタイトルの設定
% ============================================================
\titleformat{\section}
  {\normalfont\Large\bfseries}          % フォント
  {\thesection}                         % ラベル
  {1em}                                 % ラベルと本文の間隔
  {}                                    % 前に挿入するコード

\titleformat{\subsection}
  {\normalfont\large\bfseries}
  {\thesubsection}
  {1em}
  {}

\titleformat{\subsubsection}
  {\normalfont\normalsize\bfseries}
  {\thesubsubsection}
  {1em}
  {}

% ============================================================
% コードリスティングの設定
% ============================================================
\lstset{
    basicstyle=\ttfamily\small,             % 基本フォント
    keywordstyle=\color{blue},              % キーワード
    commentstyle=\color{green!60!black},    % コメント
    stringstyle=\color{red},                % 文字列
    breaklines=true,                        % 自動改行
    frame=single,                           % 枠線
    numbers=left,                           % 行番号（左）
    numberstyle=\tiny\color{gray},          % 行番号スタイル
    backgroundcolor=\color{gray!10},        % 背景色
    tabsize=4,                              % タブ幅
    showstringspaces=false,                 % 文字列中の空白を表示しない
    captionpos=b                            % キャプション位置（下）
}

% Python用スタイル
\lstdefinestyle{python}{
    language=Python,
    morekeywords={self, True, False, None}
}

% JavaScript用スタイル
\lstdefinestyle{javascript}{
    language=JavaScript,
    morekeywords={const, let, async, await}
}

% ============================================================
% 便利なコマンド定義
% ============================================================

% キーワード（太字）
\newcommand{\keyword}[1]{\textbf{#1}}

% 要旨セクション（番号なし、目次に追加）
\newcommand{\abstractsection}{%
    \section*{要旨}%
    \addcontentsline{toc}{section}{要旨}%
}

% キーワードリスト
\newcommand{\keywords}[1]{%
    \vspace{1cm}%
    \noindent\textbf{キーワード}：#1%
}

% ============================================================
% タイトルページ用設定
% ============================================================

% サブタイトル格納用
\newcommand{\@subtitle}{}
\newcommand{\subtitle}[1]{\renewcommand{\@subtitle}{#1}}

% バージョン格納用
\newcommand{\@version}{}
\newcommand{\version}[1]{\renewcommand{\@version}{#1}}

% カスタムタイトルページ
\newcommand{\maketitlepage}{%
    \begin{titlepage}
        \centering
        \vspace*{3cm}
        {\Huge \textbf{\@title}} \\
        \vspace{1cm}
        \ifx\@subtitle\empty\else
            {\Large \@subtitle} \\
            \vspace{2cm}
        \fi
        {\large \@author} \\
        \vspace{1cm}
        {\large \@date} \\
        \ifx\@version\empty\else
            \vspace{0.5cm}
            {\large バージョン \@version}
        \fi
        \vfill
    \end{titlepage}
}

% ============================================================
% 目次関連
% ============================================================

% 目次・図表目次を出力するコマンド
\newcommand{\maketoc}{%
    \tableofcontents
    \newpage
    \listoffigures
    \listoftables
    \newpage
}

% ============================================================
% End of ntsel-report.sty
% ============================================================
