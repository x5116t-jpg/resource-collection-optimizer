# eCOM-10æ¯”è¼ƒæ©Ÿèƒ½ è©³ç´°è¨­è¨ˆæ›¸

**ä½œæˆæ—¥**: 2025å¹´12æœˆ27æ—¥
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0
**å¯¾è±¡ã‚·ã‚¹ãƒ†ãƒ **: è³‡æºå›åãƒ«ãƒ¼ãƒˆæœ€é©åŒ–ãƒ„ãƒ¼ãƒ«

---

## ç›®æ¬¡

1. [æ¦‚è¦](#1-æ¦‚è¦)
2. [ç¾çŠ¶åˆ†æ](#2-ç¾çŠ¶åˆ†æ)
3. [æ©Ÿèƒ½è¦ä»¶](#3-æ©Ÿèƒ½è¦ä»¶)
4. [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ](#4-ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ)
5. [ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼](#5-ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼)
6. [UIè¨­è¨ˆ](#6-uiè¨­è¨ˆ)
7. [å®Ÿè£…è©³ç´°](#7-å®Ÿè£…è©³ç´°)
8. [GitHub Workflowè¨­è¨ˆ](#8-github-workflowè¨­è¨ˆ)
9. [ãƒ†ã‚¹ãƒˆè¨ˆç”»](#9-ãƒ†ã‚¹ãƒˆè¨ˆç”»)
10. [ä»Šå¾Œã®æ‹¡å¼µæ€§](#10-ä»Šå¾Œã®æ‹¡å¼µæ€§)

---

## 1. æ¦‚è¦

### 1.1 ç›®çš„

ç¾åœ¨ã®æœ€é©åŒ–çµæœã®æ¨ªã«ã€**eCOM-10**ï¼ˆä½é€Ÿé›»å‹•ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒã‚¹ï¼‰ã§é‹æ¬ã—ãŸå ´åˆã®çµæœã‚’æ¯”è¼ƒè¡¨ç¤ºã™ã‚‹æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ç’°å¢ƒè² è·ä½æ¸›ã‚„ã‚³ã‚¹ãƒˆæ¯”è¼ƒã®æ„æ€æ±ºå®šã‚’æ”¯æ´ã™ã‚‹ã€‚

### 1.2 èƒŒæ™¯

eCOM-10ã¯ä»¥ä¸‹ã®ç‰¹æ€§ã‚’æŒã¤:
- **æœ€é«˜é€Ÿåº¦**: 19km/hï¼ˆè¶…ä½é€Ÿï¼‰
- **èˆªç¶šè·é›¢**: 30km
- **ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²»**: 0.5 kWh/kmï¼ˆé›»æ°—ï¼‰
- **COâ‚‚æ’å‡º**: ã»ã¼ã‚¼ãƒ­ï¼ˆé›»æ°—ä½¿ç”¨ï¼‰
- **ã‚³ã‚¹ãƒˆ**: å¤‰å‹•è²»185å††/km + å›ºå®šè²»285å††/km

çŸ­è·é›¢ãƒ»è»½é‡è³‡æºã®é‹æ¬ã«ãŠã„ã¦ã€å¾“æ¥ã®ãƒ‡ã‚£ãƒ¼ã‚¼ãƒ«è»Šä¸¡ã¨æ¯”è¼ƒã—ã¦ã©ã®ç¨‹åº¦ã®ã‚³ã‚¹ãƒˆãƒ»ç’°å¢ƒè² è·å‰Šæ¸›ãŒå¯èƒ½ã‹ã‚’å¯è¦–åŒ–ã™ã‚‹ã€‚

### 1.3 é©ç”¨ç¯„å›²

- Streamlit UIã§ã®æ¯”è¼ƒè¡¨ç¤º
- GitHub Workflowã§ã®è‡ªå‹•æ¯”è¼ƒãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
- è³‡æºç¨®åˆ¥ã”ã¨ã®äº’æ›æ€§ãƒã‚§ãƒƒã‚¯

---

## 2. ç¾çŠ¶åˆ†æ

### 2.1 ç¾åœ¨ã®æœ€é©åŒ–ãƒ­ã‚¸ãƒƒã‚¯

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/services/optimizer.py`

```python
def solve_fleet_routing(
    distance_matrix: DistanceMatrix,
    depot: str,
    sink: str,
    assignments: Sequence[Tuple[VehicleType, Sequence[PickupInput]]],
    vehicle_metadata_map: Optional[Dict[str, VehicleCandidate]] = None,
) -> Union[FleetSolution, NoSolution]:
    """
    è¤‡æ•°è»Šä¸¡ã§ã®æœ€é©ãƒ«ãƒ¼ãƒˆè¨ˆç®—
    - OR-Toolsã«ã‚ˆã‚‹è·é›¢æœ€å°åŒ–
    - è»Šä¸¡å®¹é‡åˆ¶ç´„ã®è€ƒæ…®
    - ã‚³ã‚¹ãƒˆå†…è¨³ï¼ˆå›ºå®šè²»ãƒ»å¤‰å‹•è²»ãƒ»ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²»é‡ï¼‰è¨ˆç®—
    """
```

**å‡¦ç†ãƒ•ãƒ­ãƒ¼**:
1. è³‡æºç¨®åˆ¥ã”ã¨ã«å¯¾å¿œå¯èƒ½ãªè»Šä¸¡ã‚’é¸å®š
2. å„è»Šä¸¡ã«å›ååœ°ç‚¹ã‚’å‰²ã‚Šå½“ã¦
3. OR-Toolsã§ãƒ«ãƒ¼ãƒˆæœ€é©åŒ–
4. `FleetSolution`ã‚’è¿”å´

### 2.2 ç¾åœ¨ã®å‡ºåŠ›å½¢å¼

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/app.py:1424-1470`

```python
def _display_fleet_solution(
    graph,
    fleet_solution: FleetSolution,
    plan_summary: Optional[Sequence[Dict[str, object]]] = None,
) -> None:
    """
    è¤‡æ•°è»Šä¸¡ã®æœ€é©åŒ–çµæœã‚’è¡¨ç¤º
    - ç·è·é›¢ã€ç·ã‚³ã‚¹ãƒˆã€ç·ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²»é‡
    - å„è»Šä¸¡ã”ã¨ã®è©³ç´°ï¼ˆãƒ«ãƒ¼ãƒˆã€è·é›¢ã€ã‚³ã‚¹ãƒˆå†…è¨³ï¼‰
    - åœ°å›³ä¸Šã§ã®ãƒ«ãƒ¼ãƒˆå¯è¦–åŒ–
    """
```

### 2.3 eCOM-10ã®è»Šä¸¡ç‰¹æ€§

**ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹**: `data/processed/vehicles.json:1137-1217`

| é …ç›® | å€¤ |
|------|-----|
| æœ€å¤§ç©è¼‰é‡ | 1,000 kg |
| ç©è¼‰å®¹ç© | 3.0 mÂ³ |
| ç‡ƒæ–™ã‚¿ã‚¤ãƒ— | é›»æ°— |
| ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²» | 0.5 kWh/km |
| å¹´é–“èµ°è¡Œè·é›¢ | 8,000 km |
| å¤‰å‹•è²» | 185 å††/km |
| å›ºå®šè²» | 285 å††/km |
| æœ€é«˜é€Ÿåº¦ | 19 km/h |
| èˆªç¶šè·é›¢ | 30 km |
| é‹è»¢å…è¨± | æ™®é€š |

### 2.4 eCOM-10ã®è³‡æºé©åˆæ€§

**ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹**: `data/processed/compatibility.json:395-422`

#### âœ… é©åˆè³‡æºï¼ˆsupports: trueï¼‰
- è¾²æ¥­æ®‹æ¸£
- æ—æ¥­æ®‹æ
- å»ƒãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯ï¼ˆé˜²é¢¨ã‚·ãƒ¼ãƒˆå¿…è¦ï¼‰
- å¤ç´™ãƒ»æ®µãƒœãƒ¼ãƒ«ï¼ˆé˜²æ°´ã‚·ãƒ¼ãƒˆå¿…è¦ï¼‰
- å‰ªå®šæãƒ»è‰
- å»ƒé£Ÿç”¨æ²¹ï¼ˆå¯†é–‰å®¹å™¨å¿…è¦ï¼‰

#### âŒ éé©åˆè³‡æºï¼ˆsupports: falseï¼‰
- å»ºè¨­å»ƒæï¼ˆç†ç”±: é‡é‡ãƒ»æ±šæŸ“åº¦ã‹ã‚‰ä¸é©ï¼‰
- é£Ÿå“å»ƒæ£„ç‰©ï¼ˆç†ç”±: è‡­æ°—ãƒ»è¡›ç”Ÿä¸Šä¸é©ï¼‰
- é‡‘å±ã‚¹ã‚¯ãƒ©ãƒƒãƒ—ï¼ˆç†ç”±: é‡é‡è¶…éï¼‰
- å®¶ç•œç³å°¿ï¼ˆç†ç”±: è‡­æ°—ãƒ»å°‚ç”¨è»Šå¿…è¦ï¼‰
- ä¸‹æ°´æ±šæ³¥ï¼ˆç†ç”±: å°‚ç”¨è»Šå¿…è¦ï¼‰

---

## 3. æ©Ÿèƒ½è¦ä»¶

### 3.1 æ©Ÿèƒ½æ¦‚è¦

**FR-001**: ç¾è¡Œã®æœ€é©åŒ–çµæœã¨ä¸¦è¡Œã—ã¦ã€eCOM-10ã‚’ä½¿ç”¨ã—ãŸå ´åˆã®ä»£æ›¿æ¡ˆã‚’è¨ˆç®—ãƒ»è¡¨ç¤ºã™ã‚‹

**FR-002**: eCOM-10ã§é‹æ¬å¯èƒ½ãªè³‡æºã¨ä¸å¯èƒ½ãªè³‡æºã‚’è‡ªå‹•åˆ¤å®šã™ã‚‹

**FR-003**: eCOM-10ã®åˆ¶ç´„ï¼ˆèˆªç¶šè·é›¢30kmã€æœ€å¤§ç©è¼‰é‡1000kgï¼‰ã‚’è€ƒæ…®ã™ã‚‹

**FR-004**: éé©åˆè³‡æºãŒã‚ã‚‹å ´åˆã€é©åˆ‡ãªè­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹

**FR-005**: ã‚³ã‚¹ãƒˆå·®åˆ†ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼å·®åˆ†ã€COâ‚‚å‰Šæ¸›é‡ã‚’è¨ˆç®—ãƒ»è¡¨ç¤ºã™ã‚‹

### 3.2 éæ©Ÿèƒ½è¦ä»¶

**NFR-001**: æ—¢å­˜ã®æœ€é©åŒ–ãƒ­ã‚¸ãƒƒã‚¯ã«å½±éŸ¿ã‚’ä¸ãˆãªã„ï¼ˆç‹¬ç«‹ã—ãŸè¨ˆç®—ï¼‰

**NFR-002**: æ¯”è¼ƒè¨ˆç®—ã®å®Ÿè¡Œæ™‚é–“ã¯æœ€é©åŒ–ã¨åŒç­‰ï¼ˆ5ç§’ä»¥å†…ï¼‰

**NFR-003**: UIã¯ç›´æ„Ÿçš„ã§ã€å·®åˆ†ãŒä¸€ç›®ã§ã‚ã‹ã‚‹

**NFR-004**: GitHub Workflowã§è‡ªå‹•ãƒ¬ãƒãƒ¼ãƒˆç”ŸæˆãŒå¯èƒ½

---

## 4. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

### 4.1 ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Streamlit UI (src/app.py)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ æœ€é©åŒ–å®Ÿè¡Œãƒœã‚¿ãƒ³   â”‚  â”‚ eCOM-10æ¯”è¼ƒè¡¨ç¤º      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                          â”‚
            â–¼                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ solve_fleet_routing() â”‚  â”‚ compute_ecom10_          â”‚
â”‚  (æ—¢å­˜ãƒ­ã‚¸ãƒƒã‚¯)       â”‚  â”‚   alternative()          â”‚
â”‚                       â”‚  â”‚  (æ–°è¦è¿½åŠ )              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                          â”‚
            â–¼                          â–¼
      FleetSolution           FleetSolution or
      (æœ€é©è§£)                NoSolution (ä»£æ›¿æ¡ˆ)
            â”‚                          â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ _display_comparison_       â”‚
         â”‚   results()                â”‚
         â”‚  (æ–°è¦è¿½åŠ )                â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
              ä¸¦åˆ—æ¯”è¼ƒè¡¨ç¤ºUI
```

### 4.2 ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆ

#### æ–°è¦ä½œæˆãƒ•ã‚¡ã‚¤ãƒ«

1. **`src/services/ecom10_comparison.py`**
   - `compute_ecom10_alternative()`: eCOM-10ä»£æ›¿æ¡ˆè¨ˆç®—
   - `check_ecom10_compatibility()`: è³‡æºäº’æ›æ€§ãƒã‚§ãƒƒã‚¯
   - `validate_ecom10_constraints()`: åˆ¶ç´„æ¤œè¨¼

2. **`scripts/generate_ecom10_comparison_report.py`**
   - GitHub Workflowç”¨ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ

3. **`.github/workflows/ecom10-comparison.yml`**
   - CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®šç¾©

#### æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®è¿½åŠ 

1. **`src/app.py`**
   - `_display_comparison_results()`: æ¯”è¼ƒçµæœè¡¨ç¤ºUI
   - `_display_ecom10_warnings()`: éé©åˆè­¦å‘Šè¡¨ç¤º

---

## 5. ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### 5.1 æ¯”è¼ƒè¨ˆç®—ãƒ•ãƒ­ãƒ¼

```
[ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›]
  â”œâ”€ depot (è»Šåº«)
  â”œâ”€ sink (é›†ç©å ´æ‰€)
  â”œâ”€ pickup_inputs (å›ååœ°ç‚¹ + è³‡æºç¨®åˆ¥ + é‡)
  â””â”€ vehicle_catalog (è»Šä¸¡å€™è£œ)
          â”‚
          â–¼
[1. æœ€é©åŒ–å®Ÿè¡Œ] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  solve_fleet_routing()               â”‚
          â”‚                           â”‚
          â–¼                           â”‚
  FleetSolution (æœ€é©è§£)               â”‚
          â”‚                           â”‚
          â–¼                           â–¼
[2. eCOM-10ä»£æ›¿æ¡ˆè¨ˆç®—] â”€â”€â”€â”€â”€â”€â”€â”€> [3. æ¯”è¼ƒãƒ»å·®åˆ†è¨ˆç®—]
  compute_ecom10_alternative()       _display_comparison_results()
          â”‚                                   â”‚
          â–¼                                   â–¼
  â”Œâ”€ è³‡æºäº’æ›æ€§ãƒã‚§ãƒƒã‚¯                   â”Œâ”€ ã‚³ã‚¹ãƒˆå·®åˆ†
  â”œâ”€ å®¹é‡åˆ¶ç´„ãƒã‚§ãƒƒã‚¯                     â”œâ”€ ã‚¨ãƒãƒ«ã‚®ãƒ¼å·®åˆ†
  â”œâ”€ èˆªç¶šè·é›¢åˆ¶ç´„ãƒã‚§ãƒƒã‚¯                 â”œâ”€ COâ‚‚å‰Šæ¸›é‡
  â””â”€ ãƒ«ãƒ¼ãƒˆæœ€é©åŒ–                         â””â”€ è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
          â”‚                                   â”‚
          â–¼                                   â–¼
  FleetSolution / NoSolution          [4. UIè¡¨ç¤º]
                                        ä¸¦åˆ—æ¯”è¼ƒãƒ†ãƒ¼ãƒ–ãƒ«
```

### 5.2 è³‡æºäº’æ›æ€§åˆ¤å®šãƒ•ãƒ­ãƒ¼

```python
for pickup in pickup_inputs:
    resource_type = pickup["kind"]

    # eCOM-10äº’æ›æ€§ãƒã‚§ãƒƒã‚¯
    compatibility = master.compatibility["eCOM-10"]
    is_compatible = compatibility.supports.get(resource_type)

    if is_compatible == True:
        # eCOM-10ã«å‰²ã‚Šå½“ã¦
        ecom10_assignments.append(pickup)
    elif is_compatible == False:
        # éé©åˆ â†’ è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç”Ÿæˆ
        warnings.append(f"âš ï¸ {resource_type}ã¯eCOM-10ã§ã¯é‹æ¬ã§ãã¾ã›ã‚“")
        # ä»–è»Šä¸¡ã«å‰²ã‚Šå½“ã¦
        alternative_vehicle_assignments.append(pickup)
    else:
        # äº’æ›æ€§æƒ…å ±ãªã— â†’ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§éé©åˆæ‰±ã„
        warnings.append(f"âš ï¸ {resource_type}ã®äº’æ›æ€§æƒ…å ±ãŒã‚ã‚Šã¾ã›ã‚“")
```

---

## 6. UIè¨­è¨ˆ

### 6.1 æ¯”è¼ƒè¡¨ç¤ºãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

#### 6.1.1 å…¨ä½“æ§‹æˆ

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        æœ€é©åŒ–çµæœã®æ¯”è¼ƒ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æœ€é©è§£ï¼ˆæ¨å¥¨ï¼‰â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€ eCOM-10åˆ©ç”¨ã®å ´åˆ â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ† ç·è·é›¢:  45.2 km                  â”‚ â”‚ ğŸš ç·è·é›¢:  48.3 km (+3.1 km)    â”‚
â”‚ ğŸ’° ç·ã‚³ã‚¹ãƒˆ: 28,500 å††               â”‚ â”‚ ğŸ’° ç·ã‚³ã‚¹ãƒˆ: 22,700 å††           â”‚
â”‚                                      â”‚ â”‚    ğŸ”» -5,800å†† (-20%)            â”‚
â”‚ âš¡ ã‚¨ãƒãƒ«ã‚®ãƒ¼: 69.5 kWh              â”‚ â”‚ âš¡ ã‚¨ãƒãƒ«ã‚®ãƒ¼: 24.2 kWh           â”‚
â”‚    (COâ‚‚æ’å‡ºé‡ ç›¸å½“)                  â”‚ â”‚    ğŸŒ± -45.3 kWh (-65%)           â”‚
â”‚                                      â”‚ â”‚    COâ‚‚å‰Šæ¸›åŠ¹æœ: å¤§               â”‚
â”‚                                      â”‚ â”‚                                  â”‚
â”‚ ğŸ“‹ è»Šä¸¡æ§‹æˆ:                         â”‚ â”‚ ğŸ“‹ è»Šä¸¡æ§‹æˆ:                     â”‚
â”‚ ãƒ»4tå¹³ãƒœãƒ‡ã‚£ (æ—æ¥­æ®‹æ 500kg)        â”‚ â”‚ ãƒ»eCOM-10 (æ—æ¥­æ®‹æ 500kg)       â”‚
â”‚                                      â”‚ â”‚                                  â”‚
â”‚                                      â”‚ â”‚ âš ï¸ åˆ¶ç´„äº‹é …:                     â”‚
â”‚                                      â”‚ â”‚ ãƒ»æœ€é«˜é€Ÿåº¦: 19km/h              â”‚
â”‚                                      â”‚ â”‚ ãƒ»æ‰€è¦æ™‚é–“: ç´„2.5æ™‚é–“            â”‚
â”‚                                      â”‚ â”‚ ãƒ»èˆªç¶šè·é›¢: 30kmä»¥å†…ã®ã¿å¯¾å¿œ     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ’¡ æ¨å¥¨: çŸ­è·é›¢ãƒ»è»½é‡è³‡æºã®å ´åˆã€eCOM-10ã§COâ‚‚å‰Šæ¸›åŠ¹æœå¤§
```

#### 6.1.2 éé©åˆè³‡æºãŒã‚ã‚‹å ´åˆã®è¡¨ç¤º

**ã‚±ãƒ¼ã‚¹1: eCOM-10ã§ä¸€éƒ¨è³‡æºã®ã¿é‹æ¬å¯èƒ½**

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        æœ€é©åŒ–çµæœã®æ¯”è¼ƒ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æœ€é©è§£ï¼ˆæ¨å¥¨ï¼‰â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€ eCOM-10åˆ©ç”¨ã®å ´åˆ â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ† ç·è·é›¢:  52.8 km                  â”‚ â”‚ ğŸš ç·è·é›¢:  56.4 km (+3.6 km)    â”‚
â”‚ ğŸ’° ç·ã‚³ã‚¹ãƒˆ: 35,200 å††               â”‚ â”‚ ğŸ’° ç·ã‚³ã‚¹ãƒˆ: 31,800 å††           â”‚
â”‚ âš¡ ã‚¨ãƒãƒ«ã‚®ãƒ¼: 81.3 kWh               â”‚ â”‚    ğŸ”» -3,400å†† (-10%)            â”‚
â”‚                                      â”‚ â”‚ âš¡ ã‚¨ãƒãƒ«ã‚®ãƒ¼: 52.1 kWh           â”‚
â”‚ ğŸ“‹ è»Šä¸¡æ§‹æˆ:                         â”‚ â”‚    ğŸŒ± -29.2 kWh (-36%)           â”‚
â”‚ ãƒ»4tå¹³ãƒœãƒ‡ã‚£ (æ—æ¥­æ®‹æ 600kg +       â”‚ â”‚                                  â”‚
â”‚              å»ºè¨­å»ƒæ 800kg)         â”‚ â”‚ ğŸ“‹ è»Šä¸¡æ§‹æˆ:                     â”‚
â”‚                                      â”‚ â”‚ ãƒ»eCOM-10 (æ—æ¥­æ®‹æ 600kg)       â”‚
â”‚                                      â”‚ â”‚ ãƒ»2tå¹³ãƒœãƒ‡ã‚£ (å»ºè¨­å»ƒæ 800kg)    â”‚
â”‚                                      â”‚ â”‚                                  â”‚
â”‚                                      â”‚ â”‚ âš ï¸ éé©åˆè³‡æº:                   â”‚
â”‚                                      â”‚ â”‚ ãƒ»å»ºè¨­å»ƒæã¯eCOM-10ã§ã¯é‹æ¬ä¸å¯  â”‚
â”‚                                      â”‚ â”‚   ç†ç”±: é‡é‡ãƒ»æ±šæŸ“åº¦ã‹ã‚‰ä¸é©     â”‚
â”‚                                      â”‚ â”‚   â†’ 2tå¹³ãƒœãƒ‡ã‚£ã§ä»£æ›¿é‹æ¬        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âš ï¸ æ³¨æ„: éé©åˆè³‡æºãŒã‚ã‚‹ãŸã‚ã€eCOM-10ã®ã¿ã§ã¯é‹æ¬ã§ãã¾ã›ã‚“
ğŸ’¡ ææ¡ˆ: é©åˆè³‡æºã®ã¿eCOM-10ã§é‹æ¬ã—ã€ã‚³ã‚¹ãƒˆå‰Šæ¸›ã‚’å®Ÿç¾
```

**ã‚±ãƒ¼ã‚¹2: ã™ã¹ã¦ã®è³‡æºãŒeCOM-10éé©åˆ**

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        æœ€é©åŒ–çµæœã®æ¯”è¼ƒ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æœ€é©è§£ï¼ˆæ¨å¥¨ï¼‰â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ† ç·è·é›¢:  38.5 km                  â”‚
â”‚ ğŸ’° ç·ã‚³ã‚¹ãƒˆ: 26,400 å††               â”‚
â”‚ âš¡ ã‚¨ãƒãƒ«ã‚®ãƒ¼: 59.2 kWh               â”‚
â”‚                                      â”‚
â”‚ ğŸ“‹ è»Šä¸¡æ§‹æˆ:                         â”‚
â”‚ ãƒ»4tå¹³ãƒœãƒ‡ã‚£ (å»ºè¨­å»ƒæ 1200kg +      â”‚
â”‚              é‡‘å±ã‚¹ã‚¯ãƒ©ãƒƒãƒ— 600kg)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âŒ eCOM-10ã«ã‚ˆã‚‹é‹æ¬ã¯ä¸å¯èƒ½ã§ã™

ä»¥ä¸‹ã®è³‡æºã¯eCOM-10ã§ã¯é‹æ¬ã§ãã¾ã›ã‚“:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âŒ å»ºè¨­å»ƒæ (1200kg)                                â”‚
â”‚    ç†ç”±: é‡é‡ãƒ»æ±šæŸ“åº¦ã‹ã‚‰ä¸é©                       â”‚
â”‚                                                     â”‚
â”‚ âŒ é‡‘å±ã‚¹ã‚¯ãƒ©ãƒƒãƒ— (600kg)                           â”‚
â”‚    ç†ç”±: é‡é‡è¶…é                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ’¡ ä»£æ›¿æ¡ˆ:
  ãƒ»è»½é‡è³‡æºï¼ˆæ—æ¥­æ®‹æã€å¤ç´™ç­‰ï¼‰ã«å¤‰æ›´ã™ã‚‹ã“ã¨ã§
    eCOM-10ã§ã®é‹æ¬ãŒå¯èƒ½ã«ãªã‚Šã¾ã™
  ãƒ»å»ºè¨­å»ƒæãƒ»é‡‘å±ã‚¹ã‚¯ãƒ©ãƒƒãƒ—ã¯å°‚ç”¨è»Šä¸¡ãŒå¿…è¦ã§ã™
```

### 6.2 è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¨­è¨ˆ

#### 6.2.1 è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç¨®åˆ¥

| è­¦å‘Šãƒ¬ãƒ™ãƒ« | ã‚¢ã‚¤ã‚³ãƒ³ | èª¬æ˜ |
|-----------|---------|------|
| æƒ…å ± | ğŸ’¡ | eCOM-10åˆ©ç”¨å¯èƒ½ã€æ¨å¥¨äº‹é … |
| æ³¨æ„ | âš ï¸ | ä¸€éƒ¨åˆ¶ç´„ã‚ã‚Šã€ä»£æ›¿æ¡ˆã‚ã‚Š |
| ã‚¨ãƒ©ãƒ¼ | âŒ | eCOM-10åˆ©ç”¨ä¸å¯ |

#### 6.2.2 ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

```python
# éé©åˆè³‡æºã®è­¦å‘Š
INCOMPATIBLE_RESOURCE_WARNING = """
âŒ {resource_name}ã¯eCOM-10ã§ã¯é‹æ¬ã§ãã¾ã›ã‚“
   ç†ç”±: {reason}
   ä»£æ›¿è»Šä¸¡: {alternative_vehicles}
"""

# å®¹é‡è¶…éã®è­¦å‘Š
CAPACITY_EXCEEDED_WARNING = """
âš ï¸ ç·é‡é‡{total_weight}kgãŒeCOM-10ã®æœ€å¤§ç©è¼‰é‡(1000kg)ã‚’è¶…éã—ã¦ã„ã¾ã™
   è¶…éé‡: {excess_weight}kg
   å¯¾ç­–: è¤‡æ•°å°ã«åˆ†å‰²ã¾ãŸã¯ä»–è»Šä¸¡ã‚’ä½¿ç”¨
"""

# èˆªç¶šè·é›¢è¶…éã®è­¦å‘Š
RANGE_EXCEEDED_WARNING = """
âš ï¸ ç·èµ°è¡Œè·é›¢{total_distance}kmãŒeCOM-10ã®èˆªç¶šè·é›¢(30km)ã‚’è¶…éã—ã¦ã„ã¾ã™
   è¶…éè·é›¢: {excess_distance}km
   å¯¾ç­–: ã‚ˆã‚Šè¿‘ã„æ‹ ç‚¹ã‚’åˆ©ç”¨ã¾ãŸã¯ä»–è»Šä¸¡ã‚’ä½¿ç”¨
"""

# æ‰€è¦æ™‚é–“ã®æƒ…å ±
TIME_INFORMATION = """
ğŸ’¡ eCOM-10ã®æ‰€è¦æ™‚é–“: ç´„{hours}æ™‚é–“{minutes}åˆ†
   (æœ€é«˜é€Ÿåº¦19km/hã®ãŸã‚)
   é€šå¸¸è»Šä¸¡ã¨ã®æ™‚é–“å·®: +{time_difference}åˆ†
"""
```

### 6.3 UIå®Ÿè£…ï¼ˆStreamlitï¼‰

#### 6.3.1 æ¯”è¼ƒè¡¨ç¤ºé–¢æ•°

```python
def _display_comparison_results(
    graph,
    optimal_solution: FleetSolution,
    ecom10_solution: Union[FleetSolution, NoSolution],
    plan_summary: Optional[Sequence[Dict[str, object]]] = None,
) -> None:
    """
    æœ€é©è§£ã¨eCOM-10ä»£æ›¿æ¡ˆã‚’ä¸¦åˆ—è¡¨ç¤º
    """
    st.markdown("## æœ€é©åŒ–çµæœã®æ¯”è¼ƒ")
    st.markdown("---")

    col1, col2 = st.columns(2)

    # å·¦ã‚«ãƒ©ãƒ : æœ€é©è§£
    with col1:
        st.markdown("### ğŸ† æœ€é©è§£ï¼ˆæ¨å¥¨ï¼‰")
        _display_optimal_solution_summary(optimal_solution)

    # å³ã‚«ãƒ©ãƒ : eCOM-10ä»£æ›¿æ¡ˆ
    with col2:
        st.markdown("### ğŸš eCOM-10åˆ©ç”¨ã®å ´åˆ")
        if isinstance(ecom10_solution, NoSolution):
            _display_ecom10_infeasible(ecom10_solution)
        else:
            _display_ecom10_solution_summary(ecom10_solution, optimal_solution)

    # å·®åˆ†åˆ†æ
    if isinstance(ecom10_solution, FleetSolution):
        _display_difference_analysis(optimal_solution, ecom10_solution)
```

#### 6.3.2 éé©åˆè­¦å‘Šè¡¨ç¤ºé–¢æ•°

```python
def _display_ecom10_warnings(
    incompatible_resources: List[Dict[str, Any]],
    master: ProcessedMasterData,
) -> None:
    """
    eCOM-10éé©åˆè³‡æºã®è­¦å‘Šã‚’è¡¨ç¤º
    """
    if not incompatible_resources:
        return

    st.error("âŒ eCOM-10ã«ã‚ˆã‚‹é‹æ¬ã¯ä¸å¯èƒ½ã§ã™")
    st.markdown("ä»¥ä¸‹ã®è³‡æºã¯eCOM-10ã§ã¯é‹æ¬ã§ãã¾ã›ã‚“:")

    for resource in incompatible_resources:
        resource_name = resource["name"]
        quantity = resource["quantity"]

        # äº’æ›æ€§æƒ…å ±ã‹ã‚‰ç†ç”±ã‚’å–å¾—
        compatibility = master.compatibility.get("eCOM-10")
        if compatibility:
            reason = compatibility.requirements.get(resource_name, "ä¸æ˜")
        else:
            reason = "äº’æ›æ€§æƒ…å ±ãªã—"

        # ä»£æ›¿è»Šä¸¡ã®ææ¡ˆ
        alternative_vehicles = _find_alternative_vehicles(
            resource_name,
            quantity,
            master
        )

        st.warning(
            f"**âŒ {resource_name}** ({quantity}kg)\n\n"
            f"ç†ç”±: {reason}\n\n"
            f"ä»£æ›¿è»Šä¸¡: {', '.join(alternative_vehicles)}"
        )

    # ä»£æ›¿æ¡ˆã®ææ¡ˆ
    st.info(
        "ğŸ’¡ **ä»£æ›¿æ¡ˆ**:\n"
        "- è»½é‡è³‡æºï¼ˆæ—æ¥­æ®‹æã€å¤ç´™ç­‰ï¼‰ã«å¤‰æ›´ã™ã‚‹ã“ã¨ã§"
        "eCOM-10ã§ã®é‹æ¬ãŒå¯èƒ½ã«ãªã‚Šã¾ã™\n"
        "- ç¾åœ¨é¸æŠã•ã‚ŒãŸè³‡æºã¯å°‚ç”¨è»Šä¸¡ãŒå¿…è¦ã§ã™"
    )
```

---

## 7. å®Ÿè£…è©³ç´°

### 7.1 eCOM-10ä»£æ›¿æ¡ˆè¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/services/ecom10_comparison.py` (æ–°è¦ä½œæˆ)

```python
"""
eCOM-10ä»£æ›¿æ¡ˆè¨ˆç®—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
"""

from __future__ import annotations

from typing import Dict, List, Optional, Sequence, Tuple, Union
from dataclasses import dataclass

from .optimizer import (
    Solution,
    NoSolution,
    FleetSolution,
    VehicleRoute,
    NoSolutionReason,
    PickupInput,
    solve_routing,
)
from .distance_matrix import DistanceMatrix
from .vehicle_catalog import VehicleType
from .master_repository import ProcessedMasterData, VehicleCandidate


# å®šæ•°
ECOM10_MAX_CAPACITY_KG = 1000
ECOM10_MAX_RANGE_M = 30000  # 30km = 30,000m
ECOM10_MAX_SPEED_KMH = 19


@dataclass(frozen=True)
class eCOM10CompatibilityResult:
    """eCOM-10äº’æ›æ€§ãƒã‚§ãƒƒã‚¯çµæœ"""
    compatible_pickups: List[Dict[str, object]]
    incompatible_pickups: List[Dict[str, object]]
    warnings: List[str]
    total_compatible_weight: int


def check_ecom10_compatibility(
    pickup_inputs: Sequence[PickupInput],
    master: Optional[ProcessedMasterData],
) -> eCOM10CompatibilityResult:
    """
    è³‡æºã® eCOM-10 äº’æ›æ€§ã‚’ãƒã‚§ãƒƒã‚¯

    Args:
        pickup_inputs: å›ååœ°ç‚¹æƒ…å ±
        master: ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿

    Returns:
        eCOM10CompatibilityResult: äº’æ›æ€§ãƒã‚§ãƒƒã‚¯çµæœ
    """
    compatible_pickups: List[Dict[str, object]] = []
    incompatible_pickups: List[Dict[str, object]] = []
    warnings: List[str] = []
    total_compatible_weight = 0

    # ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ eCOM-10 ã®äº’æ›æ€§æƒ…å ±ã‚’å–å¾—
    ecom10_compatibility = None
    if master and master.compatibility:
        ecom10_compatibility = master.compatibility.get("eCOM-10")

    for pickup in pickup_inputs:
        resource_type = str(pickup.get("kind", ""))
        quantity = int(pickup.get("qty", 0))

        if not resource_type:
            warnings.append(f"âš ï¸ å›ååœ°ç‚¹ {pickup.get('id')} ã«è³‡æºç¨®åˆ¥ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“")
            incompatible_pickups.append(pickup)
            continue

        # äº’æ›æ€§ãƒã‚§ãƒƒã‚¯
        is_compatible = False
        incompatible_reason = "äº’æ›æ€§æƒ…å ±ãªã—"

        if ecom10_compatibility:
            support_status = ecom10_compatibility.supports.get(resource_type)

            if support_status is True:
                is_compatible = True
            elif support_status is False:
                is_compatible = False
                # éé©åˆç†ç”±ã‚’å–å¾—
                reason = ecom10_compatibility.requirements.get(resource_type)
                if reason:
                    incompatible_reason = reason
                else:
                    incompatible_reason = "è»Šä¸¡æ§‹é€ ä¸Šä¸é©åˆ"

        # åˆ¤å®šçµæœã«åŸºã¥ã„ã¦åˆ†é¡
        if is_compatible:
            compatible_pickups.append(pickup)
            total_compatible_weight += quantity
        else:
            incompatible_pickups.append(pickup)
            warnings.append(
                f"âŒ **{resource_type}** ({quantity}kg) ã¯ eCOM-10 ã§ã¯é‹æ¬ã§ãã¾ã›ã‚“\n"
                f"   ç†ç”±: {incompatible_reason}"
            )

    return eCOM10CompatibilityResult(
        compatible_pickups=compatible_pickups,
        incompatible_pickups=incompatible_pickups,
        warnings=warnings,
        total_compatible_weight=total_compatible_weight,
    )


def validate_ecom10_constraints(
    total_weight_kg: int,
    total_distance_m: float,
) -> Tuple[bool, List[str]]:
    """
    eCOM-10 ã®åˆ¶ç´„ï¼ˆå®¹é‡ãƒ»èˆªç¶šè·é›¢ï¼‰ã‚’æ¤œè¨¼

    Args:
        total_weight_kg: ç·é‡é‡ (kg)
        total_distance_m: ç·èµ°è¡Œè·é›¢ (m)

    Returns:
        (is_valid, warnings): åˆ¶ç´„ã‚’æº€ãŸã™ã‹ã€è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒªã‚¹ãƒˆ
    """
    is_valid = True
    warnings: List[str] = []

    # å®¹é‡åˆ¶ç´„ãƒã‚§ãƒƒã‚¯
    if total_weight_kg > ECOM10_MAX_CAPACITY_KG:
        is_valid = False
        excess_weight = total_weight_kg - ECOM10_MAX_CAPACITY_KG
        warnings.append(
            f"âš ï¸ ç·é‡é‡ {total_weight_kg}kg ãŒ eCOM-10 ã®æœ€å¤§ç©è¼‰é‡ ({ECOM10_MAX_CAPACITY_KG}kg) ã‚’è¶…éã—ã¦ã„ã¾ã™\n"
            f"   è¶…éé‡: {excess_weight}kg\n"
            f"   å¯¾ç­–: è¤‡æ•°å°ã«åˆ†å‰²ã¾ãŸã¯ä»–è»Šä¸¡ã‚’ä½¿ç”¨"
        )

    # èˆªç¶šè·é›¢åˆ¶ç´„ãƒã‚§ãƒƒã‚¯
    if total_distance_m > ECOM10_MAX_RANGE_M:
        is_valid = False
        excess_distance_km = (total_distance_m - ECOM10_MAX_RANGE_M) / 1000.0
        warnings.append(
            f"âš ï¸ ç·èµ°è¡Œè·é›¢ {total_distance_m / 1000.0:.1f}km ãŒ eCOM-10 ã®èˆªç¶šè·é›¢ (30km) ã‚’è¶…éã—ã¦ã„ã¾ã™\n"
            f"   è¶…éè·é›¢: {excess_distance_km:.1f}km\n"
            f"   å¯¾ç­–: ã‚ˆã‚Šè¿‘ã„æ‹ ç‚¹ã‚’åˆ©ç”¨ã¾ãŸã¯ä»–è»Šä¸¡ã‚’ä½¿ç”¨"
        )

    # æ‰€è¦æ™‚é–“ã®æƒ…å ±æä¾›ï¼ˆè­¦å‘Šã§ã¯ãªãæƒ…å ±ï¼‰
    if total_distance_m > 0:
        time_hours = (total_distance_m / 1000.0) / ECOM10_MAX_SPEED_KMH
        hours = int(time_hours)
        minutes = int((time_hours - hours) * 60)
        warnings.append(
            f"ğŸ’¡ eCOM-10 ã®æ‰€è¦æ™‚é–“: ç´„{hours}æ™‚é–“{minutes}åˆ†\n"
            f"   (æœ€é«˜é€Ÿåº¦ {ECOM10_MAX_SPEED_KMH}km/h ã®ãŸã‚)"
        )

    return is_valid, warnings


def compute_ecom10_alternative(
    distance_matrix: DistanceMatrix,
    depot: str,
    sink: str,
    pickup_inputs: Sequence[PickupInput],
    ecom10_vehicle: VehicleType,
    other_vehicles: Sequence[VehicleType],
    master: Optional[ProcessedMasterData] = None,
    vehicle_metadata_map: Optional[Dict[str, VehicleCandidate]] = None,
) -> Union[FleetSolution, NoSolution]:
    """
    eCOM-10 ã‚’ä½¿ç”¨ã—ãŸä»£æ›¿æ¡ˆã‚’è¨ˆç®—

    å‡¦ç†ãƒ•ãƒ­ãƒ¼:
    1. è³‡æºç¨®åˆ¥ã”ã¨ã« eCOM-10 äº’æ›æ€§ãƒã‚§ãƒƒã‚¯
    2. äº’æ›è³‡æº â†’ eCOM-10 ã«å‰²ã‚Šå½“ã¦
    3. éäº’æ›è³‡æº â†’ ä»–è»Šä¸¡ã«å‰²ã‚Šå½“ã¦
    4. å®¹é‡ãƒ»èˆªç¶šè·é›¢åˆ¶ç´„ãƒã‚§ãƒƒã‚¯
    5. ãƒ«ãƒ¼ãƒˆæœ€é©åŒ–å®Ÿè¡Œ
    6. FleetSolution ã‚’è¿”å´

    Args:
        distance_matrix: è·é›¢è¡Œåˆ—
        depot: è»Šåº«ãƒãƒ¼ãƒ‰ID
        sink: é›†ç©å ´æ‰€ãƒãƒ¼ãƒ‰ID
        pickup_inputs: å›ååœ°ç‚¹æƒ…å ±
        ecom10_vehicle: eCOM-10 è»Šä¸¡ã‚¿ã‚¤ãƒ—
        other_vehicles: ä»£æ›¿è»Šä¸¡å€™è£œãƒªã‚¹ãƒˆ
        master: ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿
        vehicle_metadata_map: è»Šä¸¡ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒãƒƒãƒ—

    Returns:
        FleetSolution or NoSolution: ä»£æ›¿æ¡ˆã¾ãŸã¯è§£ãªã—
    """
    # 1. äº’æ›æ€§ãƒã‚§ãƒƒã‚¯
    compatibility_result = check_ecom10_compatibility(pickup_inputs, master)

    # ã™ã¹ã¦éäº’æ›ã®å ´åˆ
    if not compatibility_result.compatible_pickups:
        return NoSolution(
            NoSolutionReason.INFEASIBLE,
            "ã™ã¹ã¦ã®è³‡æºãŒ eCOM-10 ã§ã¯é‹æ¬ã§ãã¾ã›ã‚“\n" + "\n".join(compatibility_result.warnings)
        )

    # 2. åˆ¶ç´„æ¤œè¨¼
    # ã¾ãšè·é›¢ã‚’æ¦‚ç®—ï¼ˆç°¡æ˜“çš„ã«å…¨å›ååœ°ç‚¹ã‚’è¨ªå•ã™ã‚‹è·é›¢ã‚’è¨ˆç®—ï¼‰
    # TODO: ã‚ˆã‚Šæ­£ç¢ºãªè·é›¢è¨ˆç®—ãŒå¿…è¦ãªå ´åˆã¯å…ˆã« solve_routing ã‚’å®Ÿè¡Œ

    assignments: List[Tuple[VehicleType, List[Dict[str, object]]]] = []

    # 3. eCOM-10 ã§é‹æ¬å¯èƒ½ãªè³‡æºã‚’å‰²ã‚Šå½“ã¦
    if compatibility_result.compatible_pickups:
        # å®¹é‡åˆ¶ç´„ã§åˆ†å‰²ãŒå¿…è¦ã‹åˆ¤å®š
        if compatibility_result.total_compatible_weight <= ECOM10_MAX_CAPACITY_KG:
            # 1å°ã§é‹æ¬å¯èƒ½
            assignments.append((ecom10_vehicle, compatibility_result.compatible_pickups))
        else:
            # è¤‡æ•°å°å¿…è¦
            # TODO: å®¹é‡ã‚’è€ƒæ…®ã—ãŸåˆ†å‰²ãƒ­ã‚¸ãƒƒã‚¯
            return NoSolution(
                NoSolutionReason.CAPACITY,
                f"eCOM-10 äº’æ›è³‡æºã®ç·é‡é‡ ({compatibility_result.total_compatible_weight}kg) ãŒ "
                f"æœ€å¤§ç©è¼‰é‡ ({ECOM10_MAX_CAPACITY_KG}kg) ã‚’è¶…éã—ã¦ã„ã¾ã™"
            )

    # 4. éäº’æ›è³‡æºã‚’ä»–è»Šä¸¡ã«å‰²ã‚Šå½“ã¦
    if compatibility_result.incompatible_pickups:
        # æœ€ã‚‚é©ã—ãŸä»£æ›¿è»Šä¸¡ã‚’é¸å®š
        # ã“ã“ã§ã¯ç°¡ç•¥åŒ–ã®ãŸã‚ã€ãƒªã‚¹ãƒˆã®æœ€åˆã®è»Šä¸¡ã‚’ä½¿ç”¨
        if other_vehicles:
            best_alternative = other_vehicles[0]
            assignments.append((best_alternative, compatibility_result.incompatible_pickups))
        else:
            return NoSolution(
                NoSolutionReason.INFEASIBLE,
                "éäº’æ›è³‡æºã‚’é‹æ¬ã™ã‚‹ä»£æ›¿è»Šä¸¡ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
            )

    # 5. ãƒ«ãƒ¼ãƒˆæœ€é©åŒ–å®Ÿè¡Œ
    from .optimizer import solve_fleet_routing

    fleet_solution = solve_fleet_routing(
        distance_matrix=distance_matrix,
        depot=depot,
        sink=sink,
        assignments=assignments,
        vehicle_metadata_map=vehicle_metadata_map,
    )

    return fleet_solution
```

### 7.2 UIå®Ÿè£…ï¼ˆapp.py ã¸ã®è¿½åŠ ï¼‰

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/app.py` (æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ )

```python
def _display_comparison_results(
    graph,
    optimal_solution: FleetSolution,
    ecom10_solution: Union[FleetSolution, NoSolution],
    ecom10_warnings: List[str],
    plan_summary: Optional[Sequence[Dict[str, object]]] = None,
) -> None:
    """
    æœ€é©è§£ã¨ eCOM-10 ä»£æ›¿æ¡ˆã‚’ä¸¦åˆ—è¡¨ç¤º
    """
    st.markdown("## ğŸ“Š æœ€é©åŒ–çµæœã®æ¯”è¼ƒ")
    st.markdown("---")

    col1, col2 = st.columns(2)

    # å·¦ã‚«ãƒ©ãƒ : æœ€é©è§£
    with col1:
        st.markdown("### ğŸ† æœ€é©è§£ï¼ˆæ¨å¥¨ï¼‰")
        st.metric("ç·è·é›¢ (km)", f"{optimal_solution.total_distance_m / 1000:.2f}")
        st.metric("ç·ã‚³ã‚¹ãƒˆ (å††)", f"{optimal_solution.cost_breakdown.get('total_cost', 0):,.0f}")

        energy_kwh = optimal_solution.cost_breakdown.get('energy_consumption_kwh')
        if energy_kwh:
            st.metric("ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²» (kWh)", f"{energy_kwh:.2f}")

        # è»Šä¸¡æ§‹æˆ
        st.markdown("**ğŸ“‹ è»Šä¸¡æ§‹æˆ:**")
        for idx, route in enumerate(optimal_solution.routes, start=1):
            st.write(f"ãƒ»{route.vehicle.name}")

    # å³ã‚«ãƒ©ãƒ : eCOM-10 ä»£æ›¿æ¡ˆ
    with col2:
        st.markdown("### ğŸš eCOM-10 åˆ©ç”¨ã®å ´åˆ")

        if isinstance(ecom10_solution, NoSolution):
            # è§£ãªã—ã®å ´åˆ
            st.error("âŒ eCOM-10 ã«ã‚ˆã‚‹é‹æ¬ã¯ä¸å¯èƒ½ã§ã™")
            st.write(ecom10_solution.message)

            # è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
            if ecom10_warnings:
                for warning in ecom10_warnings:
                    st.warning(warning, icon="âš ï¸")
        else:
            # è§£ã‚ã‚Šã®å ´åˆ
            distance_diff = ecom10_solution.total_distance_m - optimal_solution.total_distance_m
            cost_diff = ecom10_solution.cost - optimal_solution.cost

            st.metric(
                "ç·è·é›¢ (km)",
                f"{ecom10_solution.total_distance_m / 1000:.2f}",
                delta=f"{distance_diff / 1000:+.2f} km"
            )

            # ã‚³ã‚¹ãƒˆå·®åˆ†ï¼ˆå‰Šæ¸›ã®å ´åˆã¯ç·‘ã€å¢—åŠ ã®å ´åˆã¯èµ¤ï¼‰
            cost_percent = (cost_diff / optimal_solution.cost * 100) if optimal_solution.cost > 0 else 0
            st.metric(
                "ç·ã‚³ã‚¹ãƒˆ (å††)",
                f"{ecom10_solution.cost:,.0f}",
                delta=f"{cost_diff:+,.0f} å†† ({cost_percent:+.1f}%)",
                delta_color="inverse"  # æ¸›å°‘ãŒè‰¯ã„
            )

            # ã‚¨ãƒãƒ«ã‚®ãƒ¼å·®åˆ†
            ecom10_energy = ecom10_solution.cost_breakdown.get('energy_consumption_kwh')
            optimal_energy = optimal_solution.cost_breakdown.get('energy_consumption_kwh')

            if ecom10_energy and optimal_energy:
                energy_diff = ecom10_energy - optimal_energy
                energy_percent = (energy_diff / optimal_energy * 100) if optimal_energy > 0 else 0
                st.metric(
                    "ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²» (kWh)",
                    f"{ecom10_energy:.2f}",
                    delta=f"{energy_diff:+.2f} kWh ({energy_percent:+.1f}%)",
                    delta_color="inverse"
                )

                # CO2 å‰Šæ¸›åŠ¹æœã®è¡¨ç¤º
                if energy_diff < 0:
                    st.success(f"ğŸŒ± COâ‚‚å‰Šæ¸›åŠ¹æœ: {abs(energy_diff):.2f} kWh ç›¸å½“")

            # è»Šä¸¡æ§‹æˆ
            st.markdown("**ğŸ“‹ è»Šä¸¡æ§‹æˆ:**")
            for idx, route in enumerate(ecom10_solution.routes, start=1):
                st.write(f"ãƒ»{route.vehicle.name}")

            # è­¦å‘Šãƒ»åˆ¶ç´„æƒ…å ±
            if ecom10_warnings:
                st.markdown("**âš ï¸ åˆ¶ç´„äº‹é …:**")
                for warning in ecom10_warnings:
                    st.info(warning, icon="ğŸ’¡")

    # æ¨å¥¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    st.markdown("---")
    if isinstance(ecom10_solution, FleetSolution):
        cost_saving = optimal_solution.cost - ecom10_solution.cost
        if cost_saving > 0:
            st.success(
                f"ğŸ’¡ **æ¨å¥¨**: çŸ­è·é›¢ãƒ»è»½é‡è³‡æºã®å ´åˆã€eCOM-10 ã§ "
                f"ç´„ {cost_saving:,.0f} å††ã®ã‚³ã‚¹ãƒˆå‰Šæ¸›ã¨ COâ‚‚ å‰Šæ¸›åŠ¹æœãŒæœŸå¾…ã§ãã¾ã™"
            )
        else:
            st.info(
                "ğŸ’¡ **æ¨å¥¨**: æœ€é©è§£ã®æ–¹ãŒã‚³ã‚¹ãƒˆé¢ã§æœ‰åˆ©ã§ã™ã€‚"
                "ãŸã ã—ã€ç’°å¢ƒè² è·ä½æ¸›ã‚’é‡è¦–ã™ã‚‹å ´åˆã¯ eCOM-10 ã‚‚æ¤œè¨ä¾¡å€¤ãŒã‚ã‚Šã¾ã™"
            )


def _find_alternative_vehicles(
    resource_type: str,
    quantity: int,
    master: ProcessedMasterData,
) -> List[str]:
    """
    éé©åˆè³‡æºã«å¯¾ã™ã‚‹ä»£æ›¿è»Šä¸¡ã‚’ææ¡ˆ
    """
    alternatives = []

    for vehicle in master.vehicles:
        if not vehicle.name or not vehicle.capacity_kg:
            continue

        compatibility = master.compatibility.get(vehicle.name)
        if not compatibility:
            continue

        # äº’æ›æ€§ãƒã‚§ãƒƒã‚¯
        if compatibility.supports.get(resource_type) == True:
            # å®¹é‡ãƒã‚§ãƒƒã‚¯
            if vehicle.capacity_kg >= quantity:
                alternatives.append(vehicle.name)

    return alternatives if alternatives else ["é©åˆè»Šä¸¡ãªã—"]
```

### 7.3 æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã¸ã®çµ±åˆ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/app.py` (mainé–¢æ•°ã®ä¿®æ­£)

```python
# æœ€é©åŒ–å®Ÿè¡Œå¾Œã«è¿½åŠ 
if st.button("æœ€é©åŒ–ã‚’å®Ÿè¡Œ", type="primary", disabled=not all_passed):
    # ... (æ—¢å­˜ã®æœ€é©åŒ–ãƒ­ã‚¸ãƒƒã‚¯)

    # eCOM-10 ä»£æ›¿æ¡ˆã®è¨ˆç®—
    if "ecom10_enabled" not in st.session_state:
        st.session_state["ecom10_enabled"] = True  # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§æœ‰åŠ¹

    if st.session_state.get("ecom10_enabled"):
        with st.spinner("eCOM-10 ä»£æ›¿æ¡ˆã‚’è¨ˆç®—ä¸­..."):
            from services.ecom10_comparison import compute_ecom10_alternative

            # eCOM-10 è»Šä¸¡ã‚’å–å¾—
            ecom10_vehicle = catalog.get_vehicle("eCOM-10")

            # ä»–ã®è»Šä¸¡å€™è£œ
            other_vehicles = [v for v in catalog.list_vehicles() if v.name != "eCOM-10"]

            # ä»£æ›¿æ¡ˆè¨ˆç®—
            ecom10_result = compute_ecom10_alternative(
                distance_matrix=distance_matrix,
                depot=depot_id,
                sink=sink_id,
                pickup_inputs=pickup_inputs,
                ecom10_vehicle=ecom10_vehicle,
                other_vehicles=other_vehicles,
                master=processed_master,
                vehicle_metadata_map=vehicle_metadata_map,
            )

            # çµæœã‚’ä¿å­˜
            st.session_state["ecom10_solution"] = ecom10_result

# çµæœè¡¨ç¤ºã‚»ã‚¯ã‚·ãƒ§ãƒ³
stored_solution = st.session_state.get("latest_solution")
ecom10_solution = st.session_state.get("ecom10_solution")

if stored_solution and ecom10_solution:
    solution_obj = stored_solution.get("solution")

    # æ¯”è¼ƒè¡¨ç¤º
    _display_comparison_results(
        graph=graph,
        optimal_solution=solution_obj,
        ecom10_solution=ecom10_solution,
        ecom10_warnings=[],  # è­¦å‘Šã¯ecom10_comparisonã‹ã‚‰å–å¾—
    )
elif stored_solution:
    # æ—¢å­˜ã®è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯
    # ...
```

---

## 8. GitHub Workflowè¨­è¨ˆ

### 8.1 Workflowæ§‹æˆ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `.github/workflows/ecom10-comparison.yml` (æ–°è¦ä½œæˆ)

```yaml
name: eCOM-10 Comparison Report

on:
  push:
    branches:
      - main
      - develop
  pull_request:
    types: [opened, synchronize, reopened]
  workflow_dispatch:
    inputs:
      test_scenario:
        description: 'Test scenario to run'
        required: false
        default: 'all'
        type: choice
        options:
          - all
          - compatible_resources
          - incompatible_resources
          - mixed_resources

jobs:
  generate-comparison-report:
    name: Generate eCOM-10 Comparison Report
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'
          cache: 'pip'

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      - name: Run eCOM-10 comparison analysis
        id: analysis
        run: |
          python scripts/generate_ecom10_comparison_report.py \
            --scenario ${{ github.event.inputs.test_scenario || 'all' }} \
            --output reports/

      - name: Upload comparison report
        uses: actions/upload-artifact@v4
        with:
          name: ecom10-comparison-report-${{ github.run_number }}
          path: reports/ecom10_comparison_*.md
          retention-days: 30

      - name: Comment PR with summary
        if: github.event_name == 'pull_request'
        uses: actions/github-script@v7
        with:
          script: |
            const fs = require('fs');
            const report = fs.readFileSync('reports/ecom10_comparison_summary.md', 'utf8');

            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: report
            });

      - name: Check for regressions
        run: |
          python scripts/check_ecom10_regressions.py
```

### 8.2 ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `scripts/generate_ecom10_comparison_report.py` (æ–°è¦ä½œæˆ)

```python
"""
eCOM-10 æ¯”è¼ƒãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•ç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ

ä½¿ç”¨ä¾‹:
    python scripts/generate_ecom10_comparison_report.py --scenario all --output reports/
"""

import argparse
import json
from pathlib import Path
from datetime import datetime
from typing import Dict, List, Any

# ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ªå®šç¾©
TEST_SCENARIOS = {
    "compatible_resources": {
        "name": "äº’æ›è³‡æºã®ã¿",
        "pickups": [
            {"id": "point_1", "kind": "æ—æ¥­æ®‹æ", "qty": 500},
            {"id": "point_2", "kind": "å¤ç´™ãƒ»æ®µãƒœãƒ¼ãƒ«", "qty": 300},
        ]
    },
    "incompatible_resources": {
        "name": "éäº’æ›è³‡æºã®ã¿",
        "pickups": [
            {"id": "point_1", "kind": "å»ºè¨­å»ƒæ", "qty": 800},
            {"id": "point_2", "kind": "é‡‘å±ã‚¹ã‚¯ãƒ©ãƒƒãƒ—", "qty": 600},
        ]
    },
    "mixed_resources": {
        "name": "æ··åˆè³‡æº",
        "pickups": [
            {"id": "point_1", "kind": "æ—æ¥­æ®‹æ", "qty": 600},
            {"id": "point_2", "kind": "å»ºè¨­å»ƒæ", "qty": 800},
        ]
    },
}


def generate_report(scenario: str, output_dir: Path) -> None:
    """
    æ¯”è¼ƒãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆ
    """
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    report_path = output_dir / f"ecom10_comparison_{scenario}_{timestamp}.md"

    # TODO: å®Ÿéš›ã®æœ€é©åŒ–ãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè¡Œ
    # ã“ã“ã§ã¯ç°¡æ˜“çš„ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç”Ÿæˆ

    report_content = f"""# eCOM-10 æ¯”è¼ƒãƒ¬ãƒãƒ¼ãƒˆ

**ã‚·ãƒŠãƒªã‚ª**: {TEST_SCENARIOS[scenario]['name']}
**ç”Ÿæˆæ—¥æ™‚**: {datetime.now().strftime("%Y-%m-%d %H:%M:%S")}

## ãƒ†ã‚¹ãƒˆæ¡ä»¶

### å›ååœ°ç‚¹
"""

    for pickup in TEST_SCENARIOS[scenario]["pickups"]:
        report_content += f"- {pickup['id']}: {pickup['kind']} ({pickup['qty']}kg)\n"

    report_content += """
## æ¯”è¼ƒçµæœ

### æœ€é©è§£

| é …ç›® | å€¤ |
|------|-----|
| ç·è·é›¢ | XX.X km |
| ç·ã‚³ã‚¹ãƒˆ | XXX,XXX å†† |
| ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²» | XX.X kWh |
| è»Šä¸¡æ§‹æˆ | Xè»Šä¸¡ |

### eCOM-10 ä»£æ›¿æ¡ˆ

| é …ç›® | å€¤ | å·®åˆ† |
|------|-----|------|
| ç·è·é›¢ | XX.X km | +X.X km |
| ç·ã‚³ã‚¹ãƒˆ | XXX,XXX å†† | -X,XXX å†† |
| ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²» | XX.X kWh | -XX.X kWh |
| è»Šä¸¡æ§‹æˆ | Xè»Šä¸¡ | - |

## çµè«–

- ã‚³ã‚¹ãƒˆå‰Šæ¸›åŠ¹æœ: XX%
- ã‚¨ãƒãƒ«ã‚®ãƒ¼å‰Šæ¸›åŠ¹æœ: XX%
- COâ‚‚å‰Šæ¸›åŠ¹æœ: å¤§/ä¸­/å°
"""

    # ãƒ¬ãƒãƒ¼ãƒˆä¿å­˜
    output_dir.mkdir(parents=True, exist_ok=True)
    report_path.write_text(report_content, encoding="utf-8")

    print(f"âœ… ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆå®Œäº†: {report_path}")


def main():
    parser = argparse.ArgumentParser(description="eCOM-10 æ¯”è¼ƒãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ")
    parser.add_argument(
        "--scenario",
        choices=["all"] + list(TEST_SCENARIOS.keys()),
        default="all",
        help="ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª"
    )
    parser.add_argument(
        "--output",
        type=Path,
        default=Path("reports"),
        help="å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª"
    )

    args = parser.parse_args()

    if args.scenario == "all":
        for scenario in TEST_SCENARIOS.keys():
            generate_report(scenario, args.output)
    else:
        generate_report(args.scenario, args.output)


if __name__ == "__main__":
    main()
```

---

## 9. ãƒ†ã‚¹ãƒˆè¨ˆç”»

### 9.1 ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `tests/services/test_ecom10_comparison.py` (æ–°è¦ä½œæˆ)

```python
"""
eCOM-10 æ¯”è¼ƒãƒ­ã‚¸ãƒƒã‚¯ã®ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
"""

import pytest
from services.ecom10_comparison import (
    check_ecom10_compatibility,
    validate_ecom10_constraints,
    compute_ecom10_alternative,
)


class TestECOM10Compatibility:
    """äº’æ›æ€§ãƒã‚§ãƒƒã‚¯ã®ãƒ†ã‚¹ãƒˆ"""

    def test_compatible_resources(self, sample_master_data):
        """äº’æ›è³‡æºã®ã¿ã®å ´åˆ"""
        pickups = [
            {"id": "p1", "kind": "æ—æ¥­æ®‹æ", "qty": 500},
            {"id": "p2", "kind": "å¤ç´™ãƒ»æ®µãƒœãƒ¼ãƒ«", "qty": 300},
        ]

        result = check_ecom10_compatibility(pickups, sample_master_data)

        assert len(result.compatible_pickups) == 2
        assert len(result.incompatible_pickups) == 0
        assert result.total_compatible_weight == 800

    def test_incompatible_resources(self, sample_master_data):
        """éäº’æ›è³‡æºã®ã¿ã®å ´åˆ"""
        pickups = [
            {"id": "p1", "kind": "å»ºè¨­å»ƒæ", "qty": 1200},
            {"id": "p2", "kind": "é‡‘å±ã‚¹ã‚¯ãƒ©ãƒƒãƒ—", "qty": 600},
        ]

        result = check_ecom10_compatibility(pickups, sample_master_data)

        assert len(result.compatible_pickups) == 0
        assert len(result.incompatible_pickups) == 2
        assert len(result.warnings) == 2
        assert "å»ºè¨­å»ƒæ" in result.warnings[0]
        assert "é‡‘å±ã‚¹ã‚¯ãƒ©ãƒƒãƒ—" in result.warnings[1]


class TestECOM10Constraints:
    """åˆ¶ç´„æ¤œè¨¼ã®ãƒ†ã‚¹ãƒˆ"""

    def test_capacity_within_limit(self):
        """å®¹é‡åˆ¶ç´„å†…"""
        is_valid, warnings = validate_ecom10_constraints(800, 25000)
        assert is_valid is True

    def test_capacity_exceeded(self):
        """å®¹é‡è¶…é"""
        is_valid, warnings = validate_ecom10_constraints(1200, 25000)
        assert is_valid is False
        assert any("å®¹é‡" in w for w in warnings)

    def test_range_exceeded(self):
        """èˆªç¶šè·é›¢è¶…é"""
        is_valid, warnings = validate_ecom10_constraints(800, 35000)
        assert is_valid is False
        assert any("èˆªç¶šè·é›¢" in w for w in warnings)
```

### 9.2 çµ±åˆãƒ†ã‚¹ãƒˆ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `tests/integration/test_ecom10_workflow.py` (æ–°è¦ä½œæˆ)

```python
"""
eCOM-10 æ¯”è¼ƒæ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆ
"""

import pytest
from services.optimizer import solve_fleet_routing
from services.ecom10_comparison import compute_ecom10_alternative


class TestECOM10Workflow:
    """ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å…¨ä½“ã®ãƒ†ã‚¹ãƒˆ"""

    def test_comparison_workflow(
        self,
        sample_distance_matrix,
        sample_depot,
        sample_sink,
        sample_pickups,
        sample_vehicles,
        sample_master_data
    ):
        """æœ€é©åŒ– â†’ eCOM-10ä»£æ›¿æ¡ˆ â†’ æ¯”è¼ƒã®ãƒ•ãƒ­ãƒ¼"""

        # 1. é€šå¸¸ã®æœ€é©åŒ–
        optimal_solution = solve_fleet_routing(
            distance_matrix=sample_distance_matrix,
            depot=sample_depot,
            sink=sample_sink,
            assignments=sample_assignments,
        )

        assert optimal_solution.is_feasible

        # 2. eCOM-10 ä»£æ›¿æ¡ˆ
        ecom10_vehicle = sample_vehicles["eCOM-10"]
        other_vehicles = [v for k, v in sample_vehicles.items() if k != "eCOM-10"]

        ecom10_solution = compute_ecom10_alternative(
            distance_matrix=sample_distance_matrix,
            depot=sample_depot,
            sink=sample_sink,
            pickup_inputs=sample_pickups,
            ecom10_vehicle=ecom10_vehicle,
            other_vehicles=other_vehicles,
            master=sample_master_data,
        )

        # 3. æ¯”è¼ƒæ¤œè¨¼
        if ecom10_solution.is_feasible:
            # ã‚³ã‚¹ãƒˆãƒ»ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®å·®åˆ†ã‚’ç¢ºèª
            cost_diff = ecom10_solution.cost - optimal_solution.cost
            # å·®åˆ†ãŒåˆç†çš„ãªç¯„å›²å†…ã‹
            assert abs(cost_diff) < optimal_solution.cost * 0.5
```

### 9.3 UIãƒ†ã‚¹ãƒˆï¼ˆæ‰‹å‹•ï¼‰

| ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ | æ‰‹é † | æœŸå¾…çµæœ |
|-------------|------|----------|
| äº’æ›è³‡æºã®ã¿ | æ—æ¥­æ®‹æ500kgã‚’é¸æŠ â†’ æœ€é©åŒ–å®Ÿè¡Œ | eCOM-10ã§é‹æ¬å¯èƒ½ã€ã‚³ã‚¹ãƒˆå‰Šæ¸›è¡¨ç¤º |
| éäº’æ›è³‡æºã®ã¿ | å»ºè¨­å»ƒæ1200kgã‚’é¸æŠ â†’ æœ€é©åŒ–å®Ÿè¡Œ | eCOM-10ä¸å¯ã®è­¦å‘Šã€ä»£æ›¿è»Šä¸¡ææ¡ˆ |
| æ··åˆè³‡æº | æ—æ¥­æ®‹æ600kg + å»ºè¨­å»ƒæ800kg â†’ æœ€é©åŒ–å®Ÿè¡Œ | eCOM-10 + ä»£æ›¿è»Šä¸¡ã®æ··åˆç·¨æˆ |
| å®¹é‡è¶…é | äº’æ›è³‡æº1500kg â†’ æœ€é©åŒ–å®Ÿè¡Œ | å®¹é‡è¶…éè­¦å‘Š |
| èˆªç¶šè·é›¢è¶…é | 40kmè¶…ã®ãƒ«ãƒ¼ãƒˆ â†’ æœ€é©åŒ–å®Ÿè¡Œ | èˆªç¶šè·é›¢è­¦å‘Š |

---

## 10. ä»Šå¾Œã®æ‹¡å¼µæ€§

### 10.1 çŸ­æœŸçš„ãªæ‹¡å¼µï¼ˆ3ãƒ¶æœˆä»¥å†…ï¼‰

1. **è¤‡æ•°å° eCOM-10 ã®æœ€é©é…åˆ†**
   - ç¾åœ¨: 1å°ã®ã¿æƒ³å®š
   - æ‹¡å¼µ: è¤‡æ•°å°ã§ã®æœ€é©å‰²ã‚Šå½“ã¦ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

2. **æ™‚é–“åˆ¶ç´„ã®è€ƒæ…®**
   - ç¾åœ¨: è·é›¢ã®ã¿
   - æ‹¡å¼µ: 19km/h ã®é€Ÿåº¦åˆ¶ç´„ã«ã‚ˆã‚‹æ‰€è¦æ™‚é–“è¨ˆç®—

3. **è©³ç´°ãªã‚³ã‚¹ãƒˆåˆ†æ**
   - ç¾åœ¨: ç·ã‚³ã‚¹ãƒˆã®ã¿
   - æ‹¡å¼µ: äººä»¶è²»ãƒ»ç‡ƒæ–™è²»ãªã©ã®è©³ç´°å†…è¨³æ¯”è¼ƒ

### 10.2 ä¸­æœŸçš„ãªæ‹¡å¼µï¼ˆ6ãƒ¶æœˆä»¥å†…ï¼‰

1. **ä»–ã®EVè»Šä¸¡ã¨ã®æ¯”è¼ƒ**
   - eCOM-10 ä»¥å¤–ã®é›»æ°—è‡ªå‹•è»Š
   - ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰è»Šä¸¡

2. **ç’°å¢ƒè² è·ã®å®šé‡åŒ–**
   - COâ‚‚æ’å‡ºé‡ã®æ­£ç¢ºãªè¨ˆç®—
   - ã‚«ãƒ¼ãƒœãƒ³ãƒ•ãƒƒãƒˆãƒ—ãƒªãƒ³ãƒˆåˆ†æ

3. **ã‚³ã‚¹ãƒˆæœ€é©åŒ–**
   - é›»æ°—æ–™é‡‘ã®æ™‚é–“å¸¯åˆ¥æœ€é©åŒ–
   - å……é›»ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æœ€é©åŒ–

### 10.3 é•·æœŸçš„ãªæ‹¡å¼µï¼ˆ1å¹´ä»¥å†…ï¼‰

1. **æ©Ÿæ¢°å­¦ç¿’ã«ã‚ˆã‚‹äºˆæ¸¬**
   - éå»ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã®æœ€é©è»Šä¸¡äºˆæ¸¬
   - éœ€è¦äºˆæ¸¬ã«åŸºã¥ãè»Šä¸¡é…ç½®

2. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æœ€é©åŒ–**
   - äº¤é€šçŠ¶æ³ã‚’è€ƒæ…®ã—ãŸå‹•çš„ãƒ«ãƒ¼ãƒˆå¤‰æ›´
   - ãƒãƒƒãƒ†ãƒªãƒ¼æ®‹é‡ã‚’è€ƒæ…®ã—ãŸå……é›»è¨ˆç”»

3. **å¤šç›®çš„æœ€é©åŒ–**
   - ã‚³ã‚¹ãƒˆãƒ»ç’°å¢ƒãƒ»æ™‚é–“ã®åŒæ™‚æœ€é©åŒ–
   - ãƒ‘ãƒ¬ãƒ¼ãƒˆæœ€é©è§£ã®æç¤º

---

## ä»˜éŒ²

### A. ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

#### A.1 FleetSolution

```python
@dataclass(frozen=True)
class FleetSolution:
    routes: List[VehicleRoute]
    cost_breakdown: Dict[str, float]

    @property
    def cost(self) -> float
    @property
    def total_distance_m(self) -> float
    @property
    def is_feasible(self) -> bool
```

#### A.2 eCOM10CompatibilityResult

```python
@dataclass(frozen=True)
class eCOM10CompatibilityResult:
    compatible_pickups: List[Dict[str, object]]
    incompatible_pickups: List[Dict[str, object]]
    warnings: List[str]
    total_compatible_weight: int
```

### B. å®šæ•°å®šç¾©

```python
# eCOM-10 ä»•æ§˜
ECOM10_MAX_CAPACITY_KG = 1000
ECOM10_MAX_RANGE_M = 30000
ECOM10_MAX_SPEED_KMH = 19
ECOM10_ENERGY_CONSUMPTION_KWH_PER_KM = 0.5

# COâ‚‚æ›ç®—ä¿‚æ•°ï¼ˆkWh â†’ kg-COâ‚‚ï¼‰
CO2_FACTOR_ELECTRICITY = 0.5  # kg-COâ‚‚/kWh
CO2_FACTOR_DIESEL = 2.6       # kg-COâ‚‚/L
```

### C. ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰

| ã‚³ãƒ¼ãƒ‰ | èª¬æ˜ |
|-------|------|
| ECOM10_INCOMPATIBLE_RESOURCE | éé©åˆè³‡æº |
| ECOM10_CAPACITY_EXCEEDED | å®¹é‡è¶…é |
| ECOM10_RANGE_EXCEEDED | èˆªç¶šè·é›¢è¶…é |
| ECOM10_NO_ALTERNATIVE_VEHICLE | ä»£æ›¿è»Šä¸¡ãªã— |

---

## æ”¹è¨‚å±¥æ­´

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | æ—¥ä»˜ | å¤‰æ›´å†…å®¹ |
|-----------|------|----------|
| 1.0 | 2025-12-27 | åˆç‰ˆä½œæˆ |

---

**æ–‡æ›¸çµ‚äº†**
