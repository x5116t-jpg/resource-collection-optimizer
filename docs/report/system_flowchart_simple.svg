<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800" width="1200" height="800">
  <!-- 定義 -->
  <defs>
    <linearGradient id="grad1" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#90caf9;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="grad2" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ffb74d;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="grad3" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#66bb6a;stop-opacity:1" />
    </linearGradient>

    <marker id="arrow" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#333" />
    </marker>
  </defs>

  <!-- 背景 -->
  <rect x="0" y="0" width="1200" height="800" fill="#fafafa"/>

  <!-- タイトル -->
  <text x="600" y="40" font-family="Arial, sans-serif" font-size="32" font-weight="bold" text-anchor="middle" fill="#1565c0">
    資源回収ルート最適化システム
  </text>
  <text x="600" y="70" font-family="Arial, sans-serif" font-size="16" text-anchor="middle" fill="#666">
    システムフロー概要図
  </text>

  <!-- システム境界 -->
  <rect x="50" y="100" width="1100" height="650" rx="15" ry="15"
        fill="none" stroke="#1976d2" stroke-width="3" stroke-dasharray="10,5"/>

  <!-- ========== 入力エリア ========== -->
  <rect x="80" y="130" width="320" height="180" rx="10" ry="10"
        fill="url(#grad1)" stroke="#1976d2" stroke-width="3"/>
  <text x="240" y="165" font-family="Arial, sans-serif" font-size="22" font-weight="bold" text-anchor="middle" fill="#0d47a1">
    📥 入力
  </text>

  <!-- 入力項目 -->
  <text x="100" y="200" font-family="Arial, sans-serif" font-size="14" fill="#1565c0">
    ● 道路ネットワークデータ
  </text>
  <text x="120" y="220" font-family="Arial, sans-serif" font-size="12" fill="#424242">
    ・ノード・エッジ情報（JSON）
  </text>

  <text x="100" y="245" font-family="Arial, sans-serif" font-size="14" fill="#1565c0">
    ● マスタデータ
  </text>
  <text x="120" y="265" font-family="Arial, sans-serif" font-size="12" fill="#424242">
    ・資源種別、車種情報、適合性
  </text>

  <text x="100" y="290" font-family="Arial, sans-serif" font-size="14" fill="#1565c0">
    ● ユーザー選択
  </text>
  <text x="120" y="310" font-family="Arial, sans-serif" font-size="12" fill="#424242">
    ・車庫、回収地点、集積場所
  </text>

  <!-- ========== 処理エリア ========== -->
  <rect x="440" y="130" width="320" height="450" rx="10" ry="10"
        fill="url(#grad2)" stroke="#f57c00" stroke-width="3"/>
  <text x="600" y="165" font-family="Arial, sans-serif" font-size="22" font-weight="bold" text-anchor="middle" fill="#e65100">
    ⚙️ 処理
  </text>

  <!-- 処理ステップ -->
  <g id="step1">
    <rect x="470" y="190" width="260" height="50" rx="8" ry="8"
          fill="#fff" stroke="#f57c00" stroke-width="2"/>
    <text x="600" y="215" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#e65100">
      1. データ読込・初期化
    </text>
    <text x="600" y="230" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
      ネットワーク構築、キャッシュ生成
    </text>
  </g>

  <g id="step2">
    <rect x="470" y="255" width="260" height="50" rx="8" ry="8"
          fill="#fff" stroke="#f57c00" stroke-width="2"/>
    <text x="600" y="280" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#e65100">
      2. 地点選択（UI操作）
    </text>
    <text x="600" y="295" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
      地図クリック、資源種別・量入力
    </text>
  </g>

  <g id="step3">
    <rect x="470" y="320" width="260" height="50" rx="8" ry="8"
          fill="#fff" stroke="#f57c00" stroke-width="2"/>
    <text x="600" y="345" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#e65100">
      3. 車種割当プラン生成
    </text>
    <text x="600" y="360" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
      資源適合性チェック、最適車種選択
    </text>
  </g>

  <g id="step4">
    <rect x="470" y="385" width="260" height="50" rx="8" ry="8"
          fill="#fff" stroke="#f57c00" stroke-width="2"/>
    <text x="600" y="410" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#e65100">
      4. 距離行列計算
    </text>
    <text x="600" y="425" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
      地点間の最短経路探索
    </text>
  </g>

  <g id="step5">
    <rect x="470" y="450" width="260" height="50" rx="8" ry="8"
          fill="#fff" stroke="#f57c00" stroke-width="2"/>
    <text x="600" y="475" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#e65100">
      5. ルート最適化（VRP）
    </text>
    <text x="600" y="490" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
      総コスト最小化、訪問順序決定
    </text>
  </g>

  <g id="step6">
    <rect x="470" y="515" width="260" height="50" rx="8" ry="8"
          fill="#fff" stroke="#f57c00" stroke-width="2"/>
    <text x="600" y="540" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#e65100">
      6. 結果生成・可視化
    </text>
    <text x="600" y="555" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
      コスト計算、経路再構成、地図表示
    </text>
  </g>

  <!-- ========== 出力エリア ========== -->
  <rect x="800" y="130" width="320" height="180" rx="10" ry="10"
        fill="url(#grad3)" stroke="#388e3c" stroke-width="3"/>
  <text x="960" y="165" font-family="Arial, sans-serif" font-size="22" font-weight="bold" text-anchor="middle" fill="#1b5e20">
    📤 出力
  </text>

  <!-- 出力項目 -->
  <text x="820" y="200" font-family="Arial, sans-serif" font-size="14" fill="#2e7d32">
    ● 最適ルート情報
  </text>
  <text x="840" y="220" font-family="Arial, sans-serif" font-size="12" fill="#424242">
    ・訪問順序、総距離、使用車種
  </text>

  <text x="820" y="245" font-family="Arial, sans-serif" font-size="14" fill="#2e7d32">
    ● コスト詳細
  </text>
  <text x="840" y="265" font-family="Arial, sans-serif" font-size="12" fill="#424242">
    ・固定費、変動費、総コスト
  </text>

  <text x="820" y="290" font-family="Arial, sans-serif" font-size="14" fill="#2e7d32">
    ● 地図表示・分析結果
  </text>
  <text x="840" y="310" font-family="Arial, sans-serif" font-size="12" fill="#424242">
    ・ルート可視化、エネルギー消費量
  </text>

  <!-- ========== データ格納層（中央下部） ========== -->
  <rect x="80" y="350" width="320" height="200" rx="10" ry="10"
        fill="#f3e5f5" stroke="#7b1fa2" stroke-width="2"/>
  <text x="240" y="380" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#4a148c">
    💾 データ格納層
  </text>

  <text x="100" y="410" font-family="Arial, sans-serif" font-size="12" fill="#6a1b9a">
    ● NetworkXグラフ
  </text>
  <text x="100" y="430" font-family="Arial, sans-serif" font-size="12" fill="#6a1b9a">
    ● 地点レジストリ
  </text>
  <text x="100" y="450" font-family="Arial, sans-serif" font-size="12" fill="#6a1b9a">
    ● 車種カタログ
  </text>
  <text x="100" y="470" font-family="Arial, sans-serif" font-size="12" fill="#6a1b9a">
    ● 距離行列
  </text>
  <text x="100" y="490" font-family="Arial, sans-serif" font-size="12" fill="#6a1b9a">
    ● 空間インデックス
  </text>
  <text x="100" y="520" font-family="Arial, sans-serif" font-size="11" fill="#999">
    ※高速処理のためキャッシュ・
  </text>
  <text x="100" y="535" font-family="Arial, sans-serif" font-size="11" fill="#999">
    インデックスを内部保持
  </text>

  <!-- ========== 技術情報（右下） ========== -->
  <rect x="800" y="350" width="320" height="200" rx="10" ry="10"
        fill="#fff8e1" stroke="#f57c00" stroke-width="2"/>
  <text x="960" y="380" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#e65100">
    🔧 技術スタック
  </text>

  <text x="820" y="410" font-family="Arial, sans-serif" font-size="12" fill="#ef6c00">
    ● Streamlit（Webアプリ）
  </text>
  <text x="820" y="430" font-family="Arial, sans-serif" font-size="12" fill="#ef6c00">
    ● NetworkX（グラフ処理）
  </text>
  <text x="820" y="450" font-family="Arial, sans-serif" font-size="12" fill="#ef6c00">
    ● Folium（地図表示）
  </text>
  <text x="820" y="470" font-family="Arial, sans-serif" font-size="12" fill="#ef6c00">
    ● Pandas（データ処理）
  </text>
  <text x="820" y="500" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#d84315">
    最適化手法: VRP（配送計画問題）
  </text>
  <text x="820" y="520" font-family="Arial, sans-serif" font-size="11" fill="#999">
    貪欲法 + 局所最適化
  </text>

  <!-- ========== 矢印（データフロー） ========== -->
  <!-- 入力 → 処理 -->
  <line x1="400" y1="220" x2="440" y2="220" stroke="#333" stroke-width="4" marker-end="url(#arrow)"/>

  <!-- 処理ステップ間 -->
  <line x1="600" y1="240" x2="600" y2="255" stroke="#f57c00" stroke-width="3" marker-end="url(#arrow)"/>
  <line x1="600" y1="305" x2="600" y2="320" stroke="#f57c00" stroke-width="3" marker-end="url(#arrow)"/>
  <line x1="600" y1="370" x2="600" y2="385" stroke="#f57c00" stroke-width="3" marker-end="url(#arrow)"/>
  <line x1="600" y1="435" x2="600" y2="450" stroke="#f57c00" stroke-width="3" marker-end="url(#arrow)"/>
  <line x1="600" y1="500" x2="600" y2="515" stroke="#f57c00" stroke-width="3" marker-end="url(#arrow)"/>

  <!-- 処理 → 出力 -->
  <line x1="760" y1="540" x2="800" y2="540" stroke="#333" stroke-width="4" marker-end="url(#arrow)"/>
  <path d="M 730 540 Q 770 470, 800 220" stroke="#333" stroke-width="3" fill="none" marker-end="url(#arrow)" stroke-dasharray="5,3"/>

  <!-- 入力 → データ格納 -->
  <line x1="240" y1="310" x2="240" y2="350" stroke="#7b1fa2" stroke-width="2" marker-end="url(#arrow)" stroke-dasharray="5,3"/>

  <!-- データ格納 → 処理 -->
  <line x1="400" y1="450" x2="440" y2="450" stroke="#7b1fa2" stroke-width="2" marker-end="url(#arrow)" stroke-dasharray="5,3"/>

  <!-- ========== 凡例 ========== -->
  <rect x="80" y="600" width="1040" height="130" rx="8" ry="8"
        fill="#ffffff" stroke="#999" stroke-width="1"/>

  <text x="600" y="625" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#333">
    システムの特徴
  </text>

  <g id="feature1">
    <circle cx="110" cy="650" r="5" fill="#1976d2"/>
    <text x="125" y="655" font-family="Arial, sans-serif" font-size="12" fill="#333">
      地図クリックで直感的な地点選択
    </text>
  </g>

  <g id="feature2">
    <circle cx="110" cy="675" r="5" fill="#f57c00"/>
    <text x="125" y="680" font-family="Arial, sans-serif" font-size="12" fill="#333">
      資源と車種の適合性を自動チェック
    </text>
  </g>

  <g id="feature3">
    <circle cx="110" cy="700" r="5" fill="#388e3c"/>
    <text x="125" y="705" font-family="Arial, sans-serif" font-size="12" fill="#333">
      総コスト・エネルギー消費量の詳細分析
    </text>
  </g>

  <g id="feature4">
    <circle cx="500" cy="650" r="5" fill="#1976d2"/>
    <text x="515" y="655" font-family="Arial, sans-serif" font-size="12" fill="#333">
      複数車両の同時最適化に対応
    </text>
  </g>

  <g id="feature5">
    <circle cx="500" cy="675" r="5" fill="#f57c00"/>
    <text x="515" y="680" font-family="Arial, sans-serif" font-size="12" fill="#333">
      インタラクティブ地図でルートを可視化
    </text>
  </g>

  <g id="feature6">
    <circle cx="500" cy="700" r="5" fill="#388e3c"/>
    <text x="515" y="705" font-family="Arial, sans-serif" font-size="12" fill="#333">
      セッション状態保持で効率的な操作
    </text>
  </g>

  <!-- フッター -->
  <text x="600" y="770" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#999">
    本システムは道路ネットワーク上での資源回収ルートを最適化し、コストとエネルギー消費を最小化します
  </text>

</svg>